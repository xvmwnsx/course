{% extends 'base.html' %}
{% block title %}–°–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π{% endblock %}
{% block content %}
{% load static %}
<head>
    <link rel="stylesheet" href="{% static 'css/schedule_list.css' %}">
    <script>
        function showDay(day) {
            let days = document.querySelectorAll('.schedule-day');
            days.forEach(d => d.style.display = 'none');
            document.getElementById(day).style.display = 'table';
        }
    </script>
</head>
<h2>–°–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π</h2>

<div class="week-navigation">
    <a href="?week_offset={{ prev_week_offset }}" class="btn">‚¨ÖÔ∏è –ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è</a>
    <span>{{ start_of_week }} ‚Äî {{ end_of_week }}</span>
    <a href="?week_offset={{ next_week_offset }}" class="btn">–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è ‚û°Ô∏è</a>
</div>


{% for day, day_schedules in schedules.items %}
    <div>
        <h3>{{ day }}</h3>
        {% if day_schedules %}
            <table border="1">
                <tr>
                    <th>–î–∞—Ç–∞</th>
                    <th>–í—Ä–µ–º—è</th>
                    <th>–ü—Ä–µ–¥–º–µ—Ç</th>
                    <th>–ö–∞–±–∏–Ω–µ—Ç</th>
                    
                    {% if can_edit %}
                    <th>–ì—Ä—É–ø–ø–∞</th>
                    <th>–ò–∑–º–µ–Ω–∏—Ç—å</th>
                    {% else %}
                    <th>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</th>
                    {% endif %}
                </tr>
                {% for schedule in day_schedules %}
                    <tr>
                        <td>{{ schedule.date }}</td>
                        <td>{{ schedule.time }}</td>
                        <td>{{ schedule.subject }}</td>
                        <td>{{ schedule.cabinet }}</td>
                        
                    {% if can_edit %}
                    <td>{{ schedule.subject.group }}</td>
                    <td><a href="{% url 'schedule_edit' pk=schedule.id %}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a></td>
                    {% else %}
                    <td>{{ schedule.teacher.first_name }} {{ schedule.teacher.surname }} {{ schedule.teacher.last_name }}</td>
                    {% endif %}
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</p>
        {% endif %}
    </div>
{% endfor %}


<a href="{% url 'download_schedule' %}?week_offset={{ week_offset }}" class="btn-download">üìÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ XLSX</a>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        showDay('{{ week_days.0 }}');
    });
</script>
{% endblock %}
